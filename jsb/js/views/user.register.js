/* 
 * Copyright 2013 MyTasq.com
 * Author: Matthias Danetzky
 */

define(["mt.backbone.sio","underscore","mt.util","jquery","mt.spinner"],function(e,t,n,r,i){var s=e.View.extend({el:"#userRegisterForm",events:{"click #userRegisterSend":"validateAndSend","input #userRegisterEmail":"copyAndValidate","input #userRegisterPassword":"copyAndValidate","input #userRegisterRePassword":"copyAndValidate","input #userRegisterRememberMe":"copyAndValidate"},validateAndSend:function(){return self=this,i.show(),r("#userRegisterSend").attr("disabled","disabled"),this.model.save({},{success:function(e,t,n){i.hide(),alert("SUCCESS"+e+t+n)},error:function(e,t,n){i.hide(),self.copyAndValidate(),alert("ERROR")}}),!1},copyAndValidate:function(){var e=!0;this.model.set("email",r("#userRegisterEmail").val()),this.model.set("password",r("#userRegisterPassword").val()),this.model.set("repassword",r("#userRegisterRePassword").val()),this.model.set("rememberme",r("#userRegisterRememberMe").attr("checked")),n.validateEmail(this.model.get("email"))?(r("#userRegisterEmailCG").removeClass("error"),r("#userRegisterEmailCG").addClass("success")):(e=!1,r("#userRegisterEmailCG").removeClass("success"),r("#userRegisterEmailCG").addClass("error")),this.model.get("password")?(r("#userRegisterPasswordCG").removeClass("error"),r("#userRegisterPasswordCG").addClass("success")):(e=!1,r("#userRegisterPasswordCG").removeClass("success"),r("#userRegisterPasswordCG").addClass("error")),this.model.get("repassword")&&this.model.get("password")===this.model.get("repassword")?(r("#userRegisterRePasswordCG").removeClass("error"),r("#userRegisterRePasswordCG").addClass("success")):(e=!1,r("#userRegisterRePasswordCG").removeClass("success"),r("#userRegisterRePasswordCG").addClass("error")),e?r("#userRegisterSend").removeAttr("disabled"):(r("#userRegisterSend").attr("disabled","disabled"),r("#userRegisterSend").removeAttr("disabled"))}});return s});